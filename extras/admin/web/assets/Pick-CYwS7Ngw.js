const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-DcLEj9nV.js","assets/format-B8DKuPGh.js","assets/index-ZajWnxG1.js","assets/index-G0ic_0eP.css","assets/QTooltip-D4R9T5Fc.js","assets/QTabPanels-HGFJe3oi.js","assets/QResizeObserver-CqC5UUgk.js","assets/QTable-CXYRITav.js","assets/TouchPan-B1-PqlLb.js","assets/QPopupProxy-D0Ly69kw.js","assets/QForm-B5eZWOd2.js","assets/ClosePopup-LSrQ-VjT.js","assets/Index-2Zuzj8Ve.js","assets/QSpace-CfwQ6zIi.js","assets/QInnerLoading-DKttGab9.js","assets/QSpinnerGears-BOF8vRdR.js"])))=>i.map(i=>d[i]);
import{_ as P,ag as V,Y as S,a7 as j,$ as d,f as l,a0 as i,C as f,Z as p,ai as v,a1 as y,a4 as w,a5 as u,a3 as r,a2 as _,aj as D,an as N,a9 as b,bD as B,G as I,Q as z,ak as T,ah as L,al as O,F as R,r as c,am as U}from"./index-ZajWnxG1.js";import{Q as A,b as x,a as F,e as E}from"./format-B8DKuPGh.js";import{Q as G}from"./QTooltip-D4R9T5Fc.js";import{Q as Y}from"./QSpace-CfwQ6zIi.js";import{Q as Z}from"./QInnerLoading-DKttGab9.js";import{Q as H}from"./QTable-CXYRITav.js";import{C as q}from"./ClosePopup-LSrQ-VjT.js";import{T as C}from"./TouchPan-B1-PqlLb.js";import{c as s}from"./Index-2Zuzj8Ve.js";import"./QSpinnerGears-BOF8vRdR.js";let e;const J={props:["parameters"],emits:["close"],components:{Search:V(()=>U(()=>import("./Search-DcLEj9nV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])))},setup(){return{crud:s,template:c({}),field:c({}),pick:c({}),relations:c([]),replica:c(null),table:c({rows:[],columns:[],visibles:[],selected:null,pagination:{},loading:!1}),search:c({filters:[],empty:!0}),dialog:c({main:s.dialog.init(()=>e.dialog.main),search:s.dialog.init(()=>e.dialog.search)})}},created(){e=this;let t=s.get.object(e.parameters);e.template=s.get.object(t.template),e.replica=s.get.number(t.replica,null),e.field=s.get.object(t.field),e.relations=s.get.array(t.relations),e.pick=s.get.object(t.pick),e.pick._grid_id_=e.template._grid_id_,e.search={empty:!0,filters:s.copy(s.get.array(e.pick.table.filters))},e.table={rows:[],columns:e.pick.table.columns,visibles:e.pick.table.visibles,selected:null,pagination:{page:1,rowsPerPage:e.pick.table.page.default,sortBy:e.pick.table.order.field,descending:e.pick.table.order.descending===!0},loading:!1},e.do_request({pagination:e.table.pagination})},methods:{do_request(t){s.action.page({props:t,table:e.table,search:e.search,definition:e.pick,relations:e.relations,replica:e.pick.enableReplica===!0?e.replica:null})},on_refresh_click(){e.do_request({pagination:e.table.pagination})},on_select_click(){e.$emit("close",e.table.selected)},on_search_click(){s.dialog.show(e.dialog.search,{filters:s.copy(e.search.filters),template:e.template})},on_close_dialog_search(t){if(s.isArray(t)){let n=e.search,h,a;n.filters=t,n.empty=!0;for(const m of n.filters)if(h=s.isDefined(m.value)?m.value:"",a=s.isDefined(m.value2)?m.value2:"",h!==""||a!==""){n.empty=!1;break}s.dialog.hide(e.dialog.search),e.table.pagination.page=1,e.do_request({pagination:e.table.pagination})}},on_page_changed(){let t=+e.table.pagination.page;!isNaN(t)&&t>0&&e.do_request({pagination:e.table.pagination})}}},K={class:"full-width row flex-center text-accent q-gutter-sm"},M={class:"text-subtitle2"},W={class:"text-caption"},X={class:"col-6 q-pr-xs text-left"},$={class:"col-6 q-pl-xs text-right"};function ee(t,n,h,a,m,g){const Q=S("Search");return d(),j(R,null,[l(L,{style:y("min-width: 60vw; max-width: 90vw; max-height: 90vh;"+a.dialog.main.style)},{default:i(()=>[f((d(),p(v,{class:"q-pa-none header-main",style:y(a.crud.config?.color?.header?"background: "+a.crud.config.color.header+" !important;":"")},{default:i(()=>[l(A,{class:"q-pr-none"},{default:i(()=>[l(x,null,{default:i(()=>[l(F,{class:"text-h6 text-white"},{default:i(()=>[w(u(a.pick.title),1)]),_:1})]),_:1}),l(x,{side:""},{default:i(()=>[f((d(),p(r,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close"},{default:i(()=>[l(G,null,{default:i(()=>[w(u(t.$t("label.close")),1)]),_:1})]),_:1})),[[q]])]),_:1})]),_:1})]),_:1},8,["style"])),[[C,a.dialog.main.onDrag,void 0,{mouse:!0}]]),l(v,{style:{"max-height":"80vh"},class:"q-pa-xs q-pt-sm scroll"},{default:i(()=>[l(H,{class:"table-sticky-header q-ma-none",rows:a.table.rows,columns:a.table.columns,"visible-columns":a.table.visibles,"row-key":"_pk_",loading:a.table.loading,selection:"single",pagination:a.table.pagination,"onUpdate:pagination":n[2]||(n[2]=o=>a.table.pagination=o),dense:t.$q.screen.lt.md,"no-data-label":t.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":o=>{},"rows-per-page-options":a.crud.isObject(a.pick.table)&&a.pick.table.page?.options?a.pick.table.page.options:[10,20,30],onRequest:g.do_request,"binary-state-sort":"",separator:a.crud.isObject(a.pick.table)?a.pick.table.separator:"cell",bordered:"",style:{"max-height":"70vh"}},{top:i(()=>[l(Y),a.search.filters&&a.search.filters.length?(d(),p(r,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:g.on_search_click},{default:i(()=>[a.search.empty?_("",!0):(d(),p(E,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):_("",!0),l(r,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:a.table.loading,onClick:g.on_refresh_click},null,8,["loading","onClick"])]),"no-data":i(({message:o})=>[b("div",K,[l(I,{size:"2em",name:"block"}),b("span",M,u(o),1)])]),loading:i(()=>[l(Z,{showing:"",color:"primary"})]),"body-selection":i(o=>[l(B,{modelValue:a.table.selected,"onUpdate:modelValue":n[0]||(n[0]=k=>a.table.selected=k),val:o.row,color:"primary"},null,8,["modelValue","val"])]),pagination:i(o=>[o.pagesNumber>2?(d(),p(r,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:o.isFirstPage,onClick:o.firstPage},null,8,["disable","onClick"])):_("",!0),l(r,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:o.isFirstPage,onClick:o.prevPage},null,8,["disable","onClick"]),l(D,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:a.table.pagination.page,"onUpdate:modelValue":[n[1]||(n[1]=k=>a.table.pagination.page=k),g.on_page_changed]},N({_:2},[a.crud.isObject(a.pick.table)&&a.crud.isObject(a.pick.table.page)&&a.pick.table.page.count===!0?{name:"append",fn:i(()=>[b("span",W," / "+u(o.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),l(r,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:o.isLastPage,onClick:o.nextPage},null,8,["disable","onClick"]),o.pagesNumber>2?(d(),p(r,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:o.isLastPage,onClick:o.lastPage},null,8,["disable","onClick"])):_("",!0)]),_:1},8,["rows","columns","visible-columns","loading","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1}),l(z),l(T,{class:"row"},{default:i(()=>[b("div",X,[f(l(r,{label:t.$t("label.cancel"),color:"negative","no-caps":"",glossy:""},null,8,["label"]),[[q]])]),b("div",$,[l(r,{label:t.$t("label.select"),color:"indigo","no-caps":"",glossy:"",disable:!a.table.selected?._pk_,onClick:g.on_select_click},null,8,["label","disable","onClick"])])]),_:1})]),_:1},8,["style"]),l(O,{modelValue:a.dialog.search.show,"onUpdate:modelValue":n[3]||(n[3]=o=>a.dialog.search.show=o),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:i(()=>[f(l(Q,{parameters:a.dialog.search.parameters,onClose:g.on_close_dialog_search,style:y(a.dialog.search.style)},null,8,["parameters","onClose","style"]),[[C,a.dialog.search.onDrag,void 0,{mouse:!0}]])]),_:1},8,["modelValue"])],64)}const ge=P(J,[["render",ee]]);export{ge as default};
