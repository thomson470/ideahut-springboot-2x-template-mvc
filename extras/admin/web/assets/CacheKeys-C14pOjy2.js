import{Q as v,b as q,a as N}from"./format-B8DKuPGh.js";import{Q as _}from"./QTooltip-D4R9T5Fc.js";import{_ as z,Z as m,$ as u,a0 as t,C as w,f as o,ai as x,a1 as C,a4 as p,a5 as c,a3 as r,a2 as P,aj as S,a9 as h,ao as Q,G as U,ah as T,ac as V,af as k,ae as y,r as b,ab as I}from"./index-ZajWnxG1.js";import{Q as A}from"./QSpace-CfwQ6zIi.js";import{Q as B}from"./QInnerLoading-DKttGab9.js";import{Q as L}from"./QTable-CXYRITav.js";import{C as j}from"./ClosePopup-LSrQ-VjT.js";import{T as D}from"./TouchPan-B1-PqlLb.js";let e;const F={props:["parameters"],setup(){return{APP:I,util:y,title:b(null),name:b(null),group:b(null),table:b({rows:[],selected:[],columns:[],loading:!1,deleting:!1,clearing:!1,pagination:{page:1,rowsPerPage:30}}),dialog:b(V.dialog.init(()=>e.dialog))}},created(){e=this,e.table.columns=[{name:"key",label:e.$t("label.key"),field:"key",align:"left",sortable:!0}];let l=y.isObject(e.parameters)?e.parameters:{};e.title=l.title,e.name=l.name,e.group=l.group,e.do_request({pagination:e.table.pagination})},methods:{do_request(l){e.table.selected=[];let{page:s,rowsPerPage:f}=l?.pagination?l.pagination:e.table.pagination,n={info:{name:e.name,group:e.group},index:s,size:f};e.table.loading=!0,k.call({path:"/cache/keys",method:"post",data:n,onFinish(){e.table.loading=!1},onSuccess(d){if(e.table.rows=[],y.isObject(d)){if(y.isArray(d.data))for(const a of d.data)e.table.rows.push({key:a});let i=e.table.pagination;i.page=d.index,i.rowsPerPage=d.size,i.rowsNumber=d.records}}})},on_refresh_click(){e.do_request({pagination:e.table.pagination})},on_delete_click(){if(e.table.selected?.length){let l=[];for(const f of e.table.selected)l.push(f.key);let s={info:{name:e.name,group:e.group},keys:l};e.table.deleting=!0,k.call({path:"/cache/delete",method:"post",data:s,onSuccess(){setTimeout(function(){e.table.deleting=!1,e.do_request({pagination:e.table.pagination})},500)},onError(){e.table.deleting=!1},notify:!0})}},on_clear_click(){V.confirm(function(){let l={info:{name:e.name,group:e.group}};e.table.clearing=!0,k.call({path:"/cache/clear",method:"post",data:l,onSuccess(){setTimeout(function(){e.table.clearing=!1,e.table.pagination.page=1,e.on_refresh_click()},500)},onError(){e.table.clearing=!1},notify:!0})},"confirm.clear",e.title)},on_page_changed(){let l=+e.table.pagination.page;!isNaN(l)&&l>0&&e.do_request({pagination:e.table.pagination})}}},E={class:"full-width row flex-center text-accent q-gutter-sm"},O={class:"text-subtitle2"},R={class:"text-left"},G={class:"text-caption"};function K(l,s,f,n,d,i){return u(),m(T,{style:C("width: "+(l.$q.screen.lt.md?"100%;":"80%;")+n.dialog.style)},{default:t(()=>[w((u(),m(x,{class:"q-pa-none header-main",style:C(n.APP?.color?.header?"background: "+n.APP.color.header+" !important;":"")},{default:t(()=>[o(v,{class:"q-pr-none"},{default:t(()=>[o(q,null,{default:t(()=>[o(N,{class:"text-h6 text-white"},{default:t(()=>[p(c(n.title),1)]),_:1})]),_:1}),o(q,{side:""},{default:t(()=>[w((u(),m(r,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close"},{default:t(()=>[o(_,null,{default:t(()=>[p(c(l.$t("label.close")),1)]),_:1})]),_:1})),[[j]])]),_:1})]),_:1})]),_:1},8,["style"])),[[D,n.dialog.onDrag,void 0,{mouse:!0}]]),o(x,{style:{"max-height":"80vh"},class:"q-pa-xs q-pt-sm scroll"},{default:t(()=>[o(L,{class:"table-sticky-header q-ma-sm",rows:n.table.rows,columns:n.table.columns,"row-key":"key",loading:n.table.loading,selection:"multiple",selected:n.table.selected,"onUpdate:selected":s[1]||(s[1]=a=>n.table.selected=a),pagination:n.table.pagination,"onUpdate:pagination":s[2]||(s[2]=a=>n.table.pagination=a),dense:l.$q.screen.lt.md,"no-data-label":l.$t("error.data_not_available"),"rows-per-page-label":" ","rows-per-page-options":[10,20,30,40,50,60,70,80,90,100],"selected-rows-label":a=>{},onRequest:i.do_request,"binary-state-sort":"",separator:"cell",style:{"max-height":"70vh"},bordered:""},{top:t(()=>[o(r,{glossy:"",round:"",dense:"",class:"q-ma-none q-pl-none q-mr-md",color:"negative",icon:"delete",disable:!n.table.selected.length,loading:n.table.deleting,onClick:i.on_delete_click},{default:t(()=>[o(_,null,{default:t(()=>[p(c(l.$t("label.delete")),1)]),_:1})]),_:1},8,["disable","loading","onClick"]),o(r,{glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"deep-orange-10",icon:"clear_all",loading:n.table.clearing,onClick:i.on_clear_click},{default:t(()=>[o(_,null,{default:t(()=>[p(c(l.$t("label.clear")),1)]),_:1})]),_:1},8,["loading","onClick"]),o(A),o(r,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:n.table.loading,onClick:i.on_refresh_click},{default:t(()=>[o(_,null,{default:t(()=>[p(c(l.$t("label.refresh")),1)]),_:1})]),_:1},8,["loading","onClick"])]),"no-data":t(({message:a})=>[h("div",E,[o(U,{size:"2em",name:"block"}),h("span",O,c(a),1)])]),loading:t(()=>[o(B,{showing:"",color:"primary"})]),"header-selection":t(a=>[h("div",R,[o(Q,{dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:a.selected,"onUpdate:modelValue":g=>a.selected=g},null,8,["modelValue","onUpdate:modelValue"])])]),"body-selection":t(a=>[o(Q,{dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:a.selected,"onUpdate:modelValue":g=>a.selected=g},null,8,["modelValue","onUpdate:modelValue"])]),pagination:t(a=>[a.pagesNumber>2?(u(),m(r,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:a.isFirstPage,onClick:a.firstPage},null,8,["disable","onClick"])):P("",!0),o(r,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:a.isFirstPage,onClick:a.prevPage},null,8,["disable","onClick"]),o(S,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:n.table.pagination.page,"onUpdate:modelValue":[s[0]||(s[0]=g=>n.table.pagination.page=g),i.on_page_changed]},{append:t(()=>[h("span",G," / "+c(a.pagesNumber),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),o(r,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:a.isLastPage,onClick:a.nextPage},null,8,["disable","onClick"]),a.pagesNumber>2?(u(),m(r,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:a.isLastPage,onClick:a.lastPage},null,8,["disable","onClick"])):P("",!0)]),_:1},8,["rows","columns","loading","selected","pagination","dense","no-data-label","onRequest"])]),_:1})]),_:1},8,["style"])}const ee=z(F,[["render",K]]);export{ee as default};
