const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CacheKeys-C14pOjy2.js","assets/format-B8DKuPGh.js","assets/index-ZajWnxG1.js","assets/index-G0ic_0eP.css","assets/QTooltip-D4R9T5Fc.js","assets/QSpace-CfwQ6zIi.js","assets/QInnerLoading-DKttGab9.js","assets/QTable-CXYRITav.js","assets/ClosePopup-LSrQ-VjT.js","assets/TouchPan-B1-PqlLb.js"])))=>i.map(i=>d[i]);
import{_ as x,ag as C,Y as $,a7 as w,$ as g,f as o,a0 as r,a9 as f,a4 as u,Z as v,a2 as h,a5 as d,a3 as p,G as V,al as B,F as T,ac as _,af as k,ae as m,r as c,am as E}from"./index-ZajWnxG1.js";import{Q as O}from"./QSpace-CfwQ6zIi.js";import{Q as y}from"./QTooltip-D4R9T5Fc.js";import{Q as j}from"./QInnerLoading-DKttGab9.js";import{e as D}from"./format-B8DKuPGh.js";import{Q as N}from"./QTd-po4U0AVJ.js";import{Q as P}from"./QTable-CXYRITav.js";let e;const S={components:{Keys:C(()=>E(()=>import("./CacheKeys-C14pOjy2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])))},setup(){return{util:m,type:c(null),handler:c(null),columns:{single:[],group:[]},table:c({rows:[],columns:[],loading:!1,clearing:{},pagination:{page:1,rowsPerPage:10}}),dialog:c({keys:_.dialog.init()})}},created(){e=this,e.columns={single:[{name:"label",label:e.$t("label.name"),field:"label",align:"left",sortable:!0},{name:"limit",label:e.$t("label.limit"),field:"limit",align:"left",sortable:!0},{name:"nullable",label:e.$t("label.nullable"),field:"nullable",align:"left",sortable:!0}],group:[{name:"label",label:e.$t("label.group"),field:"label",align:"left",sortable:!0},{name:"limit",label:e.$t("label.limit"),field:"limit",align:"left",sortable:!0},{name:"nullable",label:e.$t("label.nullable"),field:"nullable",align:"left",sortable:!0},{name:"expiry",label:e.$t("label.expiry"),field:"expiry",align:"left",sortable:!0}]},e.do_init()},beforeUpdate(){this.do_init()},methods:{do_init(){let l=e.$route.query.type,t=e.$route.query.handler;l===e.type&&t===e.handler||(e.type=l,e.handler=t,e.do_request())},do_request(){e.table.loading=!0,k.call({path:"/cache/info",params:{type:e.type,handler:e.handler},onFinish(){e.table.loading=!1},onSuccess(l,t){if(t=m.isObject(t)?t:{},t.type==="group"){l=m.isObject(l)?l:{};let i=m.isObject(l.groups)?l.groups:{};e.table.columns=e.columns.group,e.table.columns[1].format=a=>a===0?e.$t("label.unlimited"):a,e.table.columns[3].format=a=>a?.value&&a.value>0?a.value+"  ("+a.unit+")":e.$t("label.never_expire"),e.table.rows=[],Object.keys(i).forEach(a=>{let s=i[a];e.table.rows.push({name:s.name,label:s.name,limit:s.limit,nullable:s.nullable,expiry:s.expiry,is_group:!0}),e.table.clearing[s.name]=!1})}else if(t.type=="single"){e.table.columns=e.columns.single,e.table.columns[1].format=i=>i===0?e.$t("label.unlimited"):i,e.table.rows=m.isArray(l)?l:[];for(const i of e.table.rows)e.table.clearing[i.name]=!1,i.is_group=!1}}})},on_clear_click(l){_.confirm(function(){let t;l.row.is_group?t={name:e.handler,group:l.row.name}:t={name:l.row.name},e.table.clearing[l.row.name]=!0,k.call({path:"/cache/clear",method:"post",data:{info:t},onSuccess(){setTimeout(function(){e.table.clearing[l.row.name]=!1,e.do_request()},500)},onError(){e.table.clearing[l.row.name]=!1},notify:!0})},"confirm.clear",l.row.label)},on_keys_click(l){_.dialog.show(e.dialog.keys,{title:l.row.label,name:l.row.is_group?e.handler:l.row.name,group:l.row.is_group?l.row.name:null})}}},U={class:"full-width row flex-center text-accent q-gutter-sm"},z={class:"text-subtitle2"},A={key:0};function F(l,t,i,a,s,b){const q=$("Keys");return g(),w(T,null,[o(P,{class:"table-sticky-header q-ma-sm",rows:a.table.rows,columns:a.table.columns,"row-key":"name",loading:a.table.loading,selection:"single",selected:a.table.selected,"onUpdate:selected":t[0]||(t[0]=n=>a.table.selected=n),pagination:a.table.pagination,"onUpdate:pagination":t[1]||(t[1]=n=>a.table.pagination=n),dense:l.$q.screen.lt.md,"no-data-label":l.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":n=>{},"binary-state-sort":"",separator:"cell",bordered:""},{top:r(()=>[o(O),o(p,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:a.table.loading,onClick:b.do_request},{default:r(()=>[o(y,null,{default:r(()=>[u(d(l.$t("label.refresh")),1)]),_:1})]),_:1},8,["loading","onClick"])]),"no-data":r(({message:n})=>[f("div",U,[o(V,{size:"2em",name:"block"}),f("span",z,d(n),1)])]),loading:r(()=>[o(j,{showing:"",color:"primary"})]),"body-selection":r(n=>[n.row.limit!==0?(g(),w("div",A,[o(p,{glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"deep-orange-10",icon:"clear_all",loading:a.table.clearing[n.row.name],onClick:Q=>b.on_clear_click(n)},{default:r(()=>[o(y,null,{default:r(()=>[u(d(l.$t("label.clear")),1)]),_:1})]),_:2},1032,["loading","onClick"]),o(p,{glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"primary",icon:"list_alt",onClick:Q=>b.on_keys_click(n)},{default:r(()=>[o(y,null,{default:r(()=>[u(d(l.$t("label.keys")),1)]),_:1})]),_:2},1032,["onClick"])])):h("",!0)]),"body-cell":r(n=>[o(N,{props:n},{default:r(()=>[f("span",null,[u(d(n.value)+" ",1),n.col.name==="label"&&n.row.isDefault===!0?(g(),v(D,{key:0,color:"orange",rounded:"",align:"top",transparent:""})):h("",!0)])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","selected","pagination","dense","no-data-label"]),o(B,{modelValue:a.dialog.keys.show,"onUpdate:modelValue":t[2]||(t[2]=n=>a.dialog.keys.show=n),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[o(q,{parameters:a.dialog.keys.parameters},null,8,["parameters"])]),_:1},8,["modelValue"])],64)}const H=x(S,[["render",F]]);export{H as default};
