const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-DcLEj9nV.js","assets/format-B8DKuPGh.js","assets/index-ZajWnxG1.js","assets/index-G0ic_0eP.css","assets/QTooltip-D4R9T5Fc.js","assets/QTabPanels-HGFJe3oi.js","assets/QResizeObserver-CqC5UUgk.js","assets/QTable-CXYRITav.js","assets/TouchPan-B1-PqlLb.js","assets/QPopupProxy-D0Ly69kw.js","assets/QForm-B5eZWOd2.js","assets/ClosePopup-LSrQ-VjT.js","assets/Index-2Zuzj8Ve.js","assets/QSpace-CfwQ6zIi.js","assets/QInnerLoading-DKttGab9.js","assets/QSpinnerGears-BOF8vRdR.js","assets/View1-Gg00xXC7.js","assets/Edit1-Duachw8a.js","assets/QFab-CHynsvqb.js"])))=>i.map(i=>d[i]);
import{_ as E,ag as h,Y as y,a7 as k,$ as s,f as t,a0 as r,C,Z as d,a2 as f,ai as v,a1 as q,a4 as Q,a5 as _,a3 as m,F as R,a8 as I,a9 as u,aj as T,an as z,ao as P,G as N,ah as L,al as V,r as p,am as x}from"./index-ZajWnxG1.js";import{Q as B,b as j,a as A,e as F}from"./format-B8DKuPGh.js";import{Q as G}from"./QTooltip-D4R9T5Fc.js";import{d as Y,Q as Z}from"./QTable-CXYRITav.js";import{Q as H}from"./QSpace-CfwQ6zIi.js";import{Q as J}from"./QInnerLoading-DKttGab9.js";import{T as O}from"./TouchPan-B1-PqlLb.js";import{c as a}from"./Index-2Zuzj8Ve.js";import"./QSpinnerGears-BOF8vRdR.js";let i;const K={props:["parameters"],emits:["close"],components:{Search:h(()=>x(()=>import("./Search-DcLEj9nV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),View1:h(()=>x(()=>import("./View1-Gg00xXC7.js"),__vite__mapDeps([16,2,3,1,4,11,8,12,13,7,14,15]))),Edit1:h(()=>x(()=>import("./Edit1-Duachw8a.js"),__vite__mapDeps([17,2,3,1,4,7,5,6,8,9,18,11,12,13,14,15])))},setup(){return{crud:a,template:p({}),definition:p({}),permission:p({}),parentRow:p({}),relations:p([]),onlyView:p(!1),replica:p(null),labels:p([]),chips:["red-10","deep-purple-10","light-blue-10","brown-10","deep-orange-10","blue-grey-10"],dialog:p({main:a.dialog.init(()=>i.dialog.main),search:a.dialog.init(()=>i.dialog.search),view:a.dialog.init(),edit:a.dialog.init()}),search:p({filters:[],empty:!0}),table:p({rows:[],columns:[],visibles:[],selected:[],pagination:{},loading:!1,deleting:!1,separator:"none"})}},created(){i=this;let o=a.get.object(i.parameters);i.template=a.get.object(o.template),i.definition=a.get.object(o.definition),i.parentRow=a.get.object(o.parentRow),i.relations=a.get.array(o.relations),i.replica=a.get.number(o.replica,null),i.onlyView=o.onlyView===!0,i.permission={actions:a.copy(i.template.actions)};let n=i.definition?.action?.exclude?i.definition.action.exclude:[];if(i.permission.actions=i.template.actions.filter(b=>!n.includes(b)),i.search={empty:!0,filters:a.copy(a.get.array(i.definition.table.filters))},i.table={rows:[],columns:i.definition.table.columns,visibles:i.definition.table.visibles,selected:[],pagination:{page:1,rowsPerPage:i.definition.table.page.default,sortBy:i.definition.table.order.field,descending:i.definition.table.order.descending===!0},loading:!1,deleting:!1,separator:a.isString(i.definition.table.separator)?i.definition.table.separator:"none"},i.labels=[],a.isArray(i.definition.labels))for(const b of i.definition.labels){let e=a.copy(b);a.isString(e.value)&&(e.value=a.getFieldValue(e.value,i.parentRow),i.labels.push(e))}i.do_request({pagination:i.table.pagination})},methods:{do_request(o){a.action.page({props:o,table:i.table,search:i.search,definition:i.definition,replica:i.definition.enableReplica===!0?i.replica:null,relations:i.relations})},on_close_click(){i.$emit("close")},on_refresh_click(){i.do_request({pagination:i.table.pagination})},on_delete_click(o){a.action.delete({row:o.row,definition:i.definition,table:i.table,deleting:i.deleting,replica:i.replica,onSuccess:function(){i.do_request({pagination:i.table.pagination})}})},on_search_click(){a.dialog.show(i.dialog.search,{filters:a.copy(i.search.filters),template:i.template})},on_close_dialog_search(o){if(a.isArray(o)){let n=i.search,b,e;n.filters=o,n.empty=!0;for(const w of n.filters)if(b=a.isDefined(w.value)?w.value:"",e=a.isDefined(w.value2)?w.value2:"",b!==""||e!==""){n.empty=!1;break}a.dialog.hide(i.dialog.search),i.table.pagination.page=1,i.do_request({pagination:i.table.pagination})}},on_view_click(o){a.dialog.show(i.dialog.view,{parentRow:i.parentRow,row:o.row,template:i.template,replica:i.replica,definition:i.definition,onlyView:i.onlyView})},on_edit_click(o){a.dialog.show(i.dialog.edit,{parentRow:i.parentRow,row:o.row,template:i.template,replica:i.replica,definition:i.definition,index:o.rowIndex,relations:i.relations})},on_add_click(){a.dialog.show(i.dialog.edit,{parentRow:i.parentRow,template:i.template,replica:i.replica,definition:i.definition,relations:i.relations})},on_close_dialog_edit(o){let n=o?.row;if(n)if(o.is_edit)if(a.isDefined(n._pk_))i.table.rows[o.index]=n;else{a.dialog.hide(i.dialog.edit),setTimeout(function(){a.dialog.show(i.dialog.edit,{row:n,parentRow:i.parentRow,template:i.template,replica:i.replica,definition:i.definition,relations:i.relations})},100);return}else i.do_request({pagination:i.table.pagination});a.dialog.hide(i.dialog.edit)},on_page_changed(){let o=+i.table.pagination.page;!isNaN(o)&&o>0&&i.do_request({pagination:i.table.pagination})}}},M={class:"q-ml-sm"},W={class:"full-width row flex-center text-accent q-gutter-sm"},X={class:"text-subtitle2"},$={key:0,class:"text-left"},ee={class:"text-caption"};function ie(o,n,b,e,w,c){const S=y("Search"),D=y("View1"),U=y("Edit1");return s(),k(R,null,[t(L,{class:"background-layout",style:q("min-width: 60vw; max-width: 90vw;"+e.dialog.main.style)},{default:r(()=>[C((s(),d(v,{class:"q-pa-none header-main",style:q(e.crud.config?.color?.header?"background: "+e.crud.config.color.header+" !important;":"")},{default:r(()=>[t(B,{class:"q-pr-none"},{default:r(()=>[t(j,null,{default:r(()=>[t(A,{class:"text-h6 text-white"},{default:r(()=>[Q(_(e.template.title+" - "+e.definition.title),1)]),_:1})]),_:1}),t(j,{side:""},{default:r(()=>[t(m,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close",onClick:c.on_close_click},{default:r(()=>[t(G,null,{default:r(()=>[Q(_(o.$t("label.close")),1)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["style"])),[[O,e.dialog.main.onDrag,void 0,{mouse:!0}]]),e.labels?.length?(s(),d(v,{key:0,class:"q-pa-sm q-mt-xs"},{default:r(()=>[(s(!0),k(R,null,I(e.labels,(l,g)=>(s(),d(Y,{key:g,color:e.chips[g%e.chips.length],"text-color":"white",class:"ellipsis-text"},{default:r(()=>[u("strong",null,[u("span",null,_(l.title)+":",1)]),u("span",M,_(l.value),1)]),_:2},1032,["color"]))),128))]),_:1})):f("",!0),t(v,{style:{"max-height":"80vh","overflow-y":"scroll !important"},class:"q-pa-xs"},{default:r(()=>[t(Z,{class:"table-sticky-header q-ma-sm",rows:e.table.rows,columns:e.table.columns,"visible-columns":e.table.visibles,"row-key":"_pk_",loading:e.table.loading,selection:e.crud.isObject(e.definition.table)?e.definition.table.selection:"single",selected:e.table.selected,"onUpdate:selected":n[1]||(n[1]=l=>e.table.selected=l),pagination:e.table.pagination,"onUpdate:pagination":n[2]||(n[2]=l=>e.table.pagination=l),dense:o.$q.screen.lt.md,"no-data-label":o.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":l=>{},"rows-per-page-options":e.crud.isObject(e.definition.table)&&e.definition.table.page?.options?e.definition.table.page.options:[10,20,30],onRequest:c.do_request,"binary-state-sort":"",separator:e.crud.isObject(e.definition.table)?e.definition.table.separator:"cell",bordered:"",style:{"max-height":"72vh"}},{top:r(()=>[e.crud.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.crud.permission.deletes(e.permission)&&!e.onlyView?(s(),d(m,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"negative",icon:"delete",disable:!e.table.selected.length,loading:e.table.deleting,onClick:c.on_delete_click},null,8,["disable","loading","onClick"])):f("",!0),e.crud.permission.add(e.permission)&&!e.onlyView?(s(),d(m,{key:1,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"teal",icon:"add",onClick:c.on_add_click},null,8,["onClick"])):f("",!0),t(H),e.search.filters?.length?(s(),d(m,{key:2,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:c.on_search_click},{default:r(()=>[e.search.empty?f("",!0):(s(),d(F,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):f("",!0),t(m,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:e.table.loading,onClick:c.on_refresh_click},null,8,["loading","onClick"])]),"no-data":r(({message:l})=>[u("div",W,[t(N,{size:"2em",name:"block"}),u("span",X,_(l),1)])]),loading:r(()=>[t(J,{showing:"",color:"primary"})]),"header-selection":r(l=>[e.crud.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.crud.permission.deletes(e.permission)&&!e.onlyView?(s(),k("div",$,[t(P,{dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:l.selected,"onUpdate:modelValue":g=>l.selected=g},null,8,["modelValue","onUpdate:modelValue"])])):f("",!0)]),"body-selection":r(l=>[e.crud.isObject(e.definition.table)&&e.definition.table.selection==="multiple"&&e.crud.permission.deletes(e.permission)&&!e.onlyView?(s(),d(P,{key:0,dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:l.selected,"onUpdate:modelValue":g=>l.selected=g},null,8,["modelValue","onUpdate:modelValue"])):e.crud.isObject(e.definition.table)&&e.crud.permission.delete(e.permission)&&!e.onlyView?(s(),d(m,{key:1,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"negative",icon:"delete",onClick:g=>c.on_delete_click(l)},null,8,["onClick"])):f("",!0),e.crud.permission.edit(e.permission)&&!e.onlyView?(s(),d(m,{key:2,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"primary",icon:"drive_file_rename_outline",onClick:g=>c.on_edit_click(l)},null,8,["onClick"])):f("",!0),e.crud.permission.view(e.permission)?(s(),d(m,{key:3,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"deep-purple",icon:"visibility",onClick:g=>c.on_view_click(l)},null,8,["onClick"])):f("",!0)]),pagination:r(l=>[l.pagesNumber>2?(s(),d(m,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:l.isFirstPage,onClick:l.firstPage},null,8,["disable","onClick"])):f("",!0),t(m,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:l.isFirstPage,onClick:l.prevPage},null,8,["disable","onClick"]),t(T,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:e.table.pagination.page,"onUpdate:modelValue":[n[0]||(n[0]=g=>e.table.pagination.page=g),c.on_page_changed]},z({_:2},[e.crud.isObject(e.definition.table)&&e.crud.isObject(e.definition.table.page)&&e.definition.table.page.count===!0?{name:"append",fn:r(()=>[u("span",ee," / "+_(l.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),t(m,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:l.isLastPage,onClick:l.nextPage},null,8,["disable","onClick"]),l.pagesNumber>2?(s(),d(m,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:l.isLastPage,onClick:l.lastPage},null,8,["disable","onClick"])):f("",!0)]),_:1},8,["rows","columns","visible-columns","loading","selection","selected","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1})]),_:1},8,["style"]),t(V,{modelValue:e.dialog.search.show,"onUpdate:modelValue":n[3]||(n[3]=l=>e.dialog.search.show=l),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[C(t(S,{parameters:e.dialog.search.parameters,onClose:c.on_close_dialog_search,style:q(e.dialog.search.style)},null,8,["parameters","onClose","style"]),[[O,e.dialog.search.onDrag,void 0,{mouse:!0}]])]),_:1},8,["modelValue"]),t(V,{modelValue:e.dialog.view.show,"onUpdate:modelValue":n[4]||(n[4]=l=>e.dialog.view.show=l),"transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[t(D,{parameters:e.dialog.view.parameters},null,8,["parameters"])]),_:1},8,["modelValue"]),t(V,{modelValue:e.dialog.edit.show,"onUpdate:modelValue":n[5]||(n[5]=l=>e.dialog.edit.show=l),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[t(U,{parameters:e.dialog.edit.parameters,onClose:c.on_close_dialog_edit},null,8,["parameters","onClose"])]),_:1},8,["modelValue"])],64)}const me=E(K,[["render",ie]]);export{me as default};
